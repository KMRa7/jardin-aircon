<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>エアコン 予約フォーム</title>
    <script
      src="https://kit.fontawesome.com/a076d05399.js"
      crossorigin="anonymous"
    ></script>

    <style>
      /* 右端の細いナビ（固定） */
      .side-nav {
        position: fixed;
        right: -5px;
        top: 80%;
        transform: translateY(-50%) translateX(15px);
        background: #13ca5e;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 4px;
        border-radius: 10px 0 0 10px;
        z-index: 1000;
        width: 35px;
      }
      .side-nav a {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        text-decoration: none;
        font-size: 10px;
        margin: 5px 0;
        padding: 5px;
        transition: background 0.3s, transform 0.2s;
        border-radius: 5px;
        width: 30px;
        height: 30px;
        text-align: center;
      }
      .side-nav a:active {
        transform: scale(1);
      }
      .side-nav a span {
        font-size: 24px;
        position: absolute;
        left: -0px;
        top: 13px;
      }
      @media (max-width: 600px) {
        .side-nav {
          right: 2px;
          width: 30px;
        }
        .side-nav a {
          width: 28px;
          height: 28px;
        }
        .side-nav a i {
          font-size: 12px;
        }
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue",
          "Segoe UI", "Noto Sans JP", sans-serif;
        background-color: #f7f7f7;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
        margin: 0;
        padding: 16px 8px 24px;
      }
      .container {
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.06);
        width: 100%;
        max-width: 480px;
        padding: 18px 16px 20px;
        box-sizing: border-box;
      }
      h1 {
        background: linear-gradient(135deg, #13ca5e, #0fa958);
        color: white;
        padding: 18px;
        border-radius: 0 15px 0px 45px;
        text-align: center;
        display: block;
        margin: -18px -12px 18px -12px;
        font-size: 22px;
        font-weight: 600;
        box-shadow: inset 0 -5px 10px rgba(0, 0, 0, 0.05);
        position: relative;
        overflow: hidden;
      }
      .highlight-background {
        background-color: #f9f9d6;
        padding: 10px 10px;
        border-radius: 10px;
        margin-bottom: 12px;
        margin-top: 5px;
        font-size: 13px;
        line-height: 1.7;
      }
      .info-text {
        margin: 8px 0 14px 0;
        font-family: "Noto Sans JP", "Roboto", sans-serif;
        font-size: 13px;
        color: #333;
        background-color: #f8f9fa;
        line-height: 1.7;
        text-align: left;
        word-wrap: break-word;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ced4da;
      }
      .label {
        display: block;
        margin-bottom: 8px;
        padding: 4px 8px;
        font-weight: 600;
        background-color: #13ca5e;
        color: white;
        border-radius: 6px;
        font-size: 15px;
        text-align: left;
        position: relative;
        overflow: hidden;
      }
      .required {
        color: #ffffff;
        font-weight: lighter;
        font-size: 0.65em;
        margin-left: 0;
        vertical-align: 0.2em;
        background-color: rgb(255, 15, 15);
        padding: 0 5px;
        border-radius: 3px;
        margin-right: 4px;
      }
      input[type="text"],
      input[type="tel"],
      textarea {
        width: 100%;
        padding: 11px 10px;
        margin-bottom: 16px;
        border: 1px solid #ccc;
        border-radius: 8px;
        box-sizing: border-box;
        font-size: 15px;
        transition: all 0.3s;
        background-color: #fff;
      }
      input:focus,
      textarea:focus {
        border-color: #13ca5e;
        outline: none;
        box-shadow: 0 0 8px rgba(19, 202, 94, 0.25);
      }
      .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 16px;
      }
      .button-group button {
        flex: 1;
        min-width: 30%;
        padding: 10px 6px;
        border-radius: 8px;
        border: 1px solid #ccc;
        background-color: #f7f7f7;
        cursor: pointer;
        box-sizing: border-box;
        text-align: center;
        white-space: nowrap;
        font-size: 14px;
        transition: all 0.2s;
      }
      .button-group button.active {
        background-color: #444;
        color: #fff;
        border-color: #444;
        outline: 2px solid #696969;
        outline-offset: 1px;
      }
      .submit-button {
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 999px;
        background-color: #dc3545;
        color: #fff;
        font-size: 17px;
        cursor: pointer;
        margin-top: 6px;
      }
      .submit-button:hover {
        background-color: #c82333;
      }
      .optional-note {
        margin-top: -10px;
        margin-bottom: 14px;
        font-size: 12px;
        color: #555;
        line-height: 1.6;
        background-color: #eef9f5;
        padding: 8px 10px;
        border-radius: 6px;
      }

      /* 移設先ブロック */
      .move-section {
        display: none;
        padding: 10px 10px 0;
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        background: #f8f9fa;
        margin-bottom: 16px;
      }
      .move-section.active {
        display: block;
      }

      @media (max-width: 768px) {
        .container {
          padding: 16px 12px 18px;
        }
        h1 {
          font-size: 20px;
        }
        input,
        textarea,
        button {
          font-size: 14px;
        }
      }

      /* ★本体情報：文字は折り返さず、ボタン幅を文字に合わせて行送りで収める */
      .bodyinfo-buttons {
        justify-content: flex-start; /* 左詰め（好みでcenterでもOK） */
      }
      
      .bodyinfo-buttons button {
        flex: 0 0 auto;       /* 伸び縮みさせず、内容幅ベースにする */
        width: auto;          /* 文字の長さに合わせて可変 */
        min-width: 0;         /* 既存の min-width: 30% を無効化 */
        white-space: nowrap;  /* 折り返さない */
        padding: 10px 10px;   /* 少し余白調整（任意） */
      }
      
      /* スマホで少しだけ文字を小さくして収まりやすく */
      @media (max-width: 600px) {
        .bodyinfo-buttons button {
          font-size: 12px;
          padding: 10px 8px;
        }
      }      
    </style>
  </head>

  <body>
    <!-- 右側の追従ナビ -->
    <div class="side-nav" id="sideNav">
      <a href="#section-message">
        <span>⇩</span>
        <i class="fas fa-comment"></i>
      </a>
    </div>

    <div class="container">
      <h1>エアコン 予約フォーム</h1>

      <!-- 依頼の注意事項（いちばん上で目立たせる） -->
      <div class="highlight-background">
        <strong>【依頼の注意事項】</strong><br />
        ※洗浄の場合は本体の型番が必要なので、エアコンの下部に貼られている型番のシールの写真をお送りください。<br />
        ※取り付け取り外しの場合は室内側の本体の全体（取り付け状況がわかる）写真と室外機の設置場所の状況がわかるような写真をお送りください。<br />
        ※LINEでの見積もりは概算になりますので、実際の費用と差異が出る場合がございます。
      </div>

      <div class="info-text">
        以下すべてご入力のうえ、画面下部の<br />
        【予約内容を送信】ボタンを押してください。
      </div>

      <!-- ① お名前 -->
      <div class="label"><span class="required">必須</span>お名前を教えてください。</div>
      <input type="text" id="name" placeholder="入力してください" />

      <!-- ② お電話番号 -->
      <div class="label"><span class="required">必須</span>お電話番号を教えてください。</div>
      <input
        type="tel"
        id="phone"
        placeholder="入力してください"
        inputmode="tel"
      />

      <!-- ③ 施行内容（選択・必須） -->
      <div class="label"><span class="required">必須</span>施行内容を選択してください。</div>
      <div class="button-group worktype-buttons">
        <button type="button" onclick="selectWorkType(this)">洗浄</button>
        <button type="button" onclick="selectWorkType(this)">取り付けのみ</button>
        <button type="button" onclick="selectWorkType(this)">取り外しのみ</button>
        <button type="button" onclick="selectWorkType(this)">取り付け取り外し</button>
      </div>

      <!-- ★追加：本体情報（選択・必須） -->
      <div class="label"><span class="required">必須</span>本体情報を選択してください。</div>
      <div class="button-group bodyinfo-buttons">
        <button type="button" onclick="selectBodyInfo(this)">ノーマルエアコン</button>
        <button type="button" onclick="selectBodyInfo(this)">お掃除機能付きエアコン</button>
        <button type="button" onclick="selectBodyInfo(this)">わからない</button>
        <button type="button" onclick="selectBodyInfo(this)">業務用天カセエアコン</button>
        <button type="button" onclick="selectBodyInfo(this)">業務用天吊りエアコン</button>
      </div>

      <!-- ④ 施行希望日時（自由記載・必須） -->
      <div class="label"><span class="required">必須</span>施行希望日時を教えてください。</div>
      <input
        type="text"
        id="preferredDate"
        placeholder="例）2026/01/10 10:00（午前/午後でも可）"
      />

      <!-- ⑤ 現住所 -->
      <div class="label"><span class="required">必須</span>現住所を教えてください。</div>
      <textarea
        id="currentAddress"
        rows="2"
        placeholder="市区町村・番地・建物名など"
      ></textarea>

      <!-- ⑥ 現住所EV -->
      <div class="label"><span class="required">必須</span>現住所のエレベーターの有無を教えてください。</div>
      <div class="button-group elevator-from-buttons">
        <button type="button" onclick="selectElevatorFrom(this)">有り</button>
        <button type="button" onclick="selectElevatorFrom(this)">無し</button>
      </div>

      <!-- ⑦ 階数 -->
      <div class="label"><span class="required">必須</span>現在お住まいの階数を教えてください。</div>
      <input
        type="text"
        id="currentFloor"
        placeholder="例）3階 / 2階メゾネット など"
      />

      <!-- ⑧⑨ 移設先（任意） -->
      <div class="move-section" id="moveSection">
        <div class="optional-note">
          「取り付け取り外し」を選択した場合に表示されます。<br />
          （移設がある場合のみご入力ください／任意）
        </div>

        <div class="label">移設先の住所を教えてください。（任意）</div>
        <textarea
          id="moveAddress"
          rows="2"
          placeholder="市区町村・番地・建物名など"
        ></textarea>

        <div class="label">移設先のエレベーターの有無を教えてください。（任意）</div>
        <input
          type="text"
          id="moveElevator"
          placeholder="例）有り / 無し / 不明"
        />
      </div>

      <!-- ➓ 決済方法（自由記載・必須） -->
      <div class="label"><span class="required">必須</span>ご希望の決済方法を教えてください。</div>
      <input
        type="text"
        id="payment"
        placeholder="例）現金 / クレジットカード / 事前振り込み など"
      />

      <button class="submit-button" onclick="submitForm()" id="section-message">
        予約内容を送信
      </button>
    </div>

    <!-- LIFF SDK -->
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>

    <script>
      let workType = "";
      let elevatorFrom = "";
      let bodyInfo = ""; // ★追加

      // LIFF初期化（必要に応じて LIFF ID を差し替え）
      document.addEventListener("DOMContentLoaded", function () {
        liff
          .init({
            liffId: "2008510250-NDDl4EXT", // ★必要ならあなたのLIFF IDに置き換えてください
          })
          .then(() => {
            console.log("LIFF初期化成功");
          })
          .catch((err) => {
            console.error("LIFF初期化失敗", err);
          });
      });

      function resetActiveButtons(selector) {
        const buttons = document.querySelectorAll(selector + " button");
        buttons.forEach((btn) => btn.classList.remove("active"));
      }

      function selectWorkType(el) {
        resetActiveButtons(".worktype-buttons");
        el.classList.add("active");
        workType = el.innerText;

        // 「取り付け取り外し」のときだけ移設先入力を表示（任意）
        const moveSection = document.getElementById("moveSection");
        if (workType === "取り付け取り外し") {
          moveSection.classList.add("active");
        } else {
          moveSection.classList.remove("active");
          // 非表示時は入力を消しておく（任意）
          document.getElementById("moveAddress").value = "";
          document.getElementById("moveElevator").value = "";
        }
      }

      function selectBodyInfo(el) {
        resetActiveButtons(".bodyinfo-buttons");
        el.classList.add("active");
        bodyInfo = el.innerText;
      }

      function selectElevatorFrom(el) {
        resetActiveButtons(".elevator-from-buttons");
        el.classList.add("active");
        elevatorFrom = el.innerText;
      }

      function submitForm() {
        const name = document.getElementById("name").value.trim();
        const phone = document.getElementById("phone").value.trim();
        const preferredDate = document.getElementById("preferredDate").value.trim();
        const currentAddress = document.getElementById("currentAddress").value.trim();
        const currentFloor = document.getElementById("currentFloor").value.trim();
        const moveAddress = document.getElementById("moveAddress").value.trim();
        const moveElevator = document.getElementById("moveElevator").value.trim();
        const payment = document.getElementById("payment").value.trim();

        // バリデーション（必須）
        if (!name) {
          alert("お名前を入力してください。");
          return;
        }
        if (!phone) {
          alert("お電話番号を入力してください。");
          return;
        }
        if (!workType) {
          alert("施行内容をご選択ください。");
          return;
        }
        if (!bodyInfo) {
          alert("本体情報をご選択ください。");
          return;
        }
        if (!preferredDate) {
          alert("施行希望日時を入力してください。");
          return;
        }
        if (!currentAddress) {
          alert("現住所を入力してください。");
          return;
        }
        if (!elevatorFrom) {
          alert("現住所のエレベーターの有無をご選択ください。");
          return;
        }
        if (!currentFloor) {
          alert("現在お住まいの階数を入力してください。");
          return;
        }
        if (!payment) {
          alert("決済方法を入力してください。");
          return;
        }

        const textMessage = `≪エアコン 予約依頼≫
【お名前】
・${name}
【お電話番号】
・${phone}
【施行内容】
・${workType}
【本体情報】
・${bodyInfo}
【施行希望日時】
・${preferredDate}
【現住所】
・${currentAddress}
【現住所エレベーターの有無】
・${elevatorFrom}
【現在お住まいの階数】
・${currentFloor}
【移設先住所（任意）】
・${moveAddress || "（未入力）"}
【移設先エレベーター（任意）】
・${moveElevator || "（未入力）"}
【決済方法】
・${payment}`;

        // LINEトークに送信
        liff
          .sendMessages([{ type: "text", text: textMessage }])
          .then(() => {
            alert("予約内容を送信しました。ありがとうございます。");
            liff.closeWindow();
          })
          .catch((err) => {
            console.error("メッセージ送信失敗", err);
            alert("送信中にエラーが発生しました。再度お試しください。");
          });
      }
    </script>
  </body>
</html>
